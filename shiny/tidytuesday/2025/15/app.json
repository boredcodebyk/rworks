[{"name":"app.R","content":"library(shiny)\r\nlibrary(bslib)\r\nlibrary(tidyverse)\r\n\r\npenguins = read.csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-04-15/penguins.csv')\r\n\r\nplot1 = ggplot(penguins, mapping = aes(fill = species, x = species,y = body_mass, colour = species, shape = species)) + geom_bar(position = \"dodge\", stat =\"identity\") + facet_wrap(~island)\r\n\r\npage1 <- \r\n  layout_column_wrap(\r\n    width = 1/2,\r\n    height = 280,\r\n    card(\r\n      height = 280,\r\n      card_header(\"Visualization\"),\r\n      card_body(plotOutput(\"plot1\"))\r\n    ),\r\n    card(height = 280,\r\n         card_header(\"Table\"),\r\n         card_body(DT::DTOutput(\"dataTable1\"))\r\n    )\r\n  )\r\n\r\npage2 <- card(\r\n  height = 300,\r\n  card_header(\"Body mass for each species, split by gender\"),\r\n  card_body(\r\n    plotOutput(\"plot2\")\r\n  )\r\n)\r\n\r\nui <- \r\n  page_navbar(\r\n    \r\n    \r\n    theme = bs_theme(bootswatch = \"minty\"),\r\n    \r\n    title = \"TidyTuesday Week 15\",\r\n    id = \"nav\",\r\n    nav_panel(\"Home\", \r\n       layout_sidebar(\r\n        sidebar = sidebar(\r\n          selectInput(inputId = \"y1\", label = \"Y-axis:\",\r\n                      choices = c(\"body_mass\",\r\n                                  \"bill_len\" ,\r\n                                  \"bill_dep\",\r\n                                  \"flipper_len\" ),\r\n                      selected = \"body_mass\")\r\n        ),\r\n        \r\n        page1\r\n      )\r\n    ),\r\n    nav_panel(\"Body Mass\", page2),\r\n    nav_panel(\"About\",\r\n      markdown(\"\r\n        # About\r\n        \r\n        ### Data source\r\n        [The R Datasets Package](https://www.r-project.org/)\r\n        \r\n        ### Data\r\n        [Base R Penguins](https://github.com/rfordatascience/tidytuesday/blob/main/data/2025/2025-04-15/readme.md)\r\n      \")\r\n    )\r\n  )\r\n\r\n\r\n# Define server logic required to draw a histogram\r\nserver <- function(input, output) {\r\n  observe({\r\n    sidebar_toggle(\r\n      id = \"sidebar\",\r\n      open = input$nav != \"Home\"\r\n    )\r\n  })\r\n    output$plot1 <- renderPlot({\r\n      y1_name <- switch (input$y1,\r\n                        \"body_mass\" = \"Body Mass (g)\",\r\n                        \"bill_len\" = \"Bill Length (mm)\",\r\n                        \"bill_dep\" = \"Bill Depth (mm)\",\r\n                        \"flipper_len\" = \"Flipper length (mm)\"\r\n      )\r\n      title_part <- switch (input$y1,\r\n                            \"body_mass\" = \"Body Mass\",\r\n                            \"bill_len\" = \"Bill Length\",\r\n                            \"bill_dep\" = \"Bill Depth\",\r\n                            \"flipper_len\" = \"Flipper length\"\r\n      )\r\n      ggplot(penguins, mapping = aes(fill = species, x = species,y = !!sym(input$y1), colour = species, shape = species)) + geom_bar(position = \"dodge\", stat =\"identity\") + facet_wrap(~island) + labs(title = paste0(title_part,\" and Penguin Species\"),subtitle = \"Categorized by Islands\", x = \"Species\", y = y1_name)\r\n    })\r\n    \r\n    output$plot2 <- renderPlot({\r\n      ggplot(penguins, mapping = aes(x = body_mass, fill = species)) + geom_density(alpha = 0.5) + facet_wrap(~sex, dir=\"v\") +\r\n      labs(x = \"Body mass (g)\", y = \"Density\")\r\n    })\r\n    \r\n    output$dataTable1 <- renderDataTable(\r\n      penguins, options = list(pageLength = 5)\r\n    )\r\n    \r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
